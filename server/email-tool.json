{
  "type": "email",
  "value": "import json\nfrom datetime import datetime\n\n# Get data from previous steps\nanalysis_data = previous_step_results.get(\"LLM Content Analysis\", {}).get(\"result\", {})\n\nif analysis_data.get(\"status\") != \"success\":\n    error_msg = analysis_data.get(\"error\", \"Unknown error occurred\")\n    \n    result = {\n        \"to\": \"yash.daga@juspay.in\",\n        \"subject\": \"‚ùå LLM Analysis Failed\",\n        \"body\": f'''\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <style>\n        body {{ font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; background: #f5f7fa; }}\n        .container {{ max-width: 700px; margin: 0 auto; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }}\n        .header {{ background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; padding: 30px; text-align: center; }}\n        .content {{ padding: 30px; }}\n        .error-box {{ background: #f8d7da; padding: 20px; border-radius: 8px; border: 1px solid #f5c6cb; color: #721c24; }}\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>‚ùå LLM Analysis Failed</h1>\n        </div>\n        <div class=\"content\">\n            <div class=\"error-box\">\n                <strong>Error:</strong> {error_msg}\n            </div>\n        </div>\n    </div>\n</body>\n</html>\n        ''',\n        \"content_type\": \"text/html\"\n    }\nelse:\n    file_name = analysis_data.get(\"file_name\", \"Document\")\n    llm_analysis = analysis_data.get(\"llm_analysis\", \"No analysis available\")\n    model_used = analysis_data.get(\"model_used\", \"Unknown\")\n    tokens_used = analysis_data.get(\"tokens_used\", \"Unknown\")\n    content_length = analysis_data.get(\"extracted_content_length\", 0)\n    processed_at = analysis_data.get(\"processed_at\", \"Unknown\")\n    \n    subject = f\"ü§ñ LLM Analysis: {file_name}\"\n    \n    # Create HTML email with LLM analysis\n    html_body = f'''\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <style>\n        body {{ font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; background: #f5f7fa; }}\n        .container {{ max-width: 700px; margin: 0 auto; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }}\n        .header {{ background: linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%); color: white; padding: 30px; text-align: center; }}\n        .header h1 {{ margin: 0; font-size: 24px; font-weight: 400; }}\n        .header .badge {{ background: rgba(255,255,255,0.2); padding: 5px 15px; border-radius: 20px; font-size: 14px; margin-top: 10px; display: inline-block; }}\n        .content {{ padding: 30px; }}\n        .file-info {{ background: #e7e3ff; padding: 20px; border-radius: 8px; margin-bottom: 25px; border-left: 4px solid #6f42c1; }}\n        .analysis-box {{ background: #f8f9fa; padding: 25px; border-radius: 8px; border: 1px solid #dee2e6; }}\n        .analysis-content {{ color: #2c3e50; line-height: 1.8; white-space: pre-line; font-size: 15px; }}\n        .stats {{ display: flex; justify-content: space-around; background: #e9ecef; padding: 15px; border-radius: 8px; margin: 20px 0; }}\n        .stat {{ text-align: center; }}\n        .stat-number {{ font-size: 18px; font-weight: bold; color: #6f42c1; }}\n        .footer {{ background: #2c3e50; color: white; padding: 20px; text-align: center; font-size: 14px; }}\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>ü§ñ LLM Document Analysis</h1>\n            <div class=\"badge\">AI-Powered Analysis</div>\n        </div>\n        \n        <div class=\"content\">\n            <div class=\"file-info\">\n                <strong>üìÑ File:</strong> {file_name}<br>\n                <strong>ü§ñ AI Model:</strong> {model_used}<br>\n                <strong>üî¢ Tokens Used:</strong> {tokens_used}<br>\n                <strong>üìä Content Length:</strong> {content_length:,} characters<br>\n                <strong>‚è∞ Processed:</strong> {processed_at}\n            </div>\n\n            <div class=\"stats\">\n                <div class=\"stat\">\n                    <div class=\"stat-number\">ü§ñ</div>\n                    <div>LLM Analysis</div>\n                </div>\n                <div class=\"stat\">\n                    <div class=\"stat-number\">{tokens_used}</div>\n                    <div>Tokens</div>\n                </div>\n                <div class=\"stat\">\n                    <div class=\"stat-number\">üîç</div>\n                    <div>AI-Powered</div>\n                </div>\n            </div>\n\n            <div class=\"analysis-box\">\n                <h3 style=\"color: #6f42c1; margin-top: 0;\">üß† AI Analysis Results:</h3>\n                <div class=\"analysis-content\">{llm_analysis}</div>\n            </div>\n        </div>\n        \n        <div class=\"footer\">\n            ü§ñ LLM Document Analysis ‚Ä¢ Powered by {model_used} ‚Ä¢ Real AI Processing\n        </div>\n    </div>\n</body>\n</html>\n    '''\n\n    result = {\n        \"to\": \"yash.daga@juspay.in\",\n        \"subject\": subject,\n        \"body\": html_body,\n        \"content_type\": \"text/html\"\n    }",
  "config": {
    "recipient": "yash.daga@juspay.in",
    "from_email": "aman.asrani@juspay.in",
    "content_type": "html"
  },
  "createdBy": "system"
}
