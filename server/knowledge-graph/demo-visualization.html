<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowledge Graph Visualization</title>
    <script src="https://unpkg.com/cytoscape@3.26.0/dist/cytoscape.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .controls {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .controls button {
            margin: 5px;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            background: #007bff;
            color: white;
            cursor: pointer;
        }
        
        .controls button:hover {
            background: #0056b3;
        }
        
        .graph-container {
            width: 100%;
            height: 600px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .stats {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .color-box {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üï∏Ô∏è Knowledge Graph Visualization</h1>
        
        <div class="controls">
            <button onclick="changeLayout('cose')">Force Layout</button>
            <button onclick="changeLayout('circle')">Circle Layout</button>
            <button onclick="changeLayout('grid')">Grid Layout</button>
            <button onclick="changeLayout('breadthfirst')">Hierarchical</button>
            <button onclick="resetZoom()">Reset Zoom</button>
            <button onclick="fitToScreen()">Fit to Screen</button>
        </div>
        
        <div id="cy" class="graph-container"></div>
        
        <div class="stats">
            <h3>üìä Graph Statistics</h3>
            <div id="stats-content">
                <p>Nodes: <span id="node-count">0</span></p>
                <p>Edges: <span id="edge-count">0</span></p>
            </div>
            
            <h4>üé® Entity Types</h4>
            <div id="legend" class="legend"></div>
        </div>
    </div>

    <script>
        // Sample knowledge graph data (in real app, this would come from your API)
        const sampleData = {
            elements: [
                // Nodes
                { data: { id: 'techcorp', label: 'TechCorp', type: 'ORGANIZATION' }, style: { 'background-color': '#4ECDC4', 'width': 60, 'height': 60 } },
                { data: { id: 'john-smith', label: 'John Smith', type: 'PERSON' }, style: { 'background-color': '#FF6B6B', 'width': 50, 'height': 50 } },
                { data: { id: 'maria-rodriguez', label: 'Maria Rodriguez', type: 'PERSON' }, style: { 'background-color': '#FF6B6B', 'width': 40, 'height': 40 } },
                { data: { id: 'sarah-chen', label: 'Dr. Sarah Chen', type: 'PERSON' }, style: { 'background-color': '#FF6B6B', 'width': 45, 'height': 45 } },
                { data: { id: 'datasystems', label: 'DataSystems Inc', type: 'ORGANIZATION' }, style: { 'background-color': '#4ECDC4', 'width': 55, 'height': 55 } },
                { data: { id: 'intellicloud', label: 'IntelliCloud', type: 'PRODUCT' }, style: { 'background-color': '#FFEAA7', 'width': 50, 'height': 50 } },
                { data: { id: 'lawfirm', label: 'LawFirm Partners', type: 'ORGANIZATION' }, style: { 'background-color': '#4ECDC4', 'width': 45, 'height': 45 } },
                { data: { id: 'sf', label: 'San Francisco', type: 'LOCATION' }, style: { 'background-color': '#45B7D1', 'width': 40, 'height': 40 } },
                
                // Edges
                { data: { source: 'john-smith', target: 'techcorp', label: 'CEO_OF' }, style: { 'line-color': '#FF6B6B', 'target-arrow-color': '#FF6B6B', 'width': 3 } },
                { data: { source: 'techcorp', target: 'datasystems', label: 'ACQUIRED' }, style: { 'line-color': '#FFD93D', 'target-arrow-color': '#FFD93D', 'width': 4 } },
                { data: { source: 'maria-rodriguez', target: 'lawfirm', label: 'WORKS_AT' }, style: { 'line-color': '#FF8C94', 'target-arrow-color': '#FF8C94', 'width': 2 } },
                { data: { source: 'maria-rodriguez', target: 'techcorp', label: 'ADVISED' }, style: { 'line-color': '#9B59B6', 'target-arrow-color': '#9B59B6', 'width': 2 } },
                { data: { source: 'sarah-chen', target: 'techcorp', label: 'WORKS_AT' }, style: { 'line-color': '#FF8C94', 'target-arrow-color': '#FF8C94', 'width': 2 } },
                { data: { source: 'sarah-chen', target: 'intellicloud', label: 'DEVELOPED' }, style: { 'line-color': '#6BCF7F', 'target-arrow-color': '#6BCF7F', 'width': 3 } },
                { data: { source: 'techcorp', target: 'intellicloud', label: 'DEVELOPED' }, style: { 'line-color': '#6BCF7F', 'target-arrow-color': '#6BCF7F', 'width': 3 } },
            ]
        };

        // Entity type colors for legend
        const entityTypeColors = {
            'PERSON': '#FF6B6B',
            'ORGANIZATION': '#4ECDC4',
            'LOCATION': '#45B7D1',
            'PRODUCT': '#FFEAA7',
            'CONCEPT': '#96CEB4',
            'EVENT': '#DDA0DD',
            'DATE': '#98D8C8'
        };

        // Initialize Cytoscape
        let cy = cytoscape({
            container: document.getElementById('cy'),
            elements: sampleData.elements,
            style: [
                {
                    selector: 'node',
                    style: {
                        'background-color': 'data(style.background-color)',
                        'width': 'data(style.width)',
                        'height': 'data(style.height)',
                        'label': 'data(label)',
                        'text-valign': 'center',
                        'text-halign': 'center',
                        'color': '#333',
                        'font-size': '12px',
                        'font-weight': 'bold',
                        'text-outline-width': 2,
                        'text-outline-color': '#fff',
                        'border-width': 2,
                        'border-color': '#333',
                        'overlay-padding': '6px'
                    }
                },
                {
                    selector: 'edge',
                    style: {
                        'line-color': 'data(style.line-color)',
                        'target-arrow-color': 'data(style.target-arrow-color)',
                        'target-arrow-shape': 'triangle',
                        'curve-style': 'bezier',
                        'width': 'data(style.width)',
                        'label': 'data(label)',
                        'font-size': '10px',
                        'text-rotation': 'autorotate',
                        'text-margin-y': -10,
                        'color': '#666'
                    }
                },
                {
                    selector: 'node:selected',
                    style: {
                        'border-width': 4,
                        'border-color': '#000'
                    }
                },
                {
                    selector: 'edge:selected',
                    style: {
                        'width': 4,
                        'line-color': '#000',
                        'target-arrow-color': '#000'
                    }
                }
            ],
            layout: {
                name: 'cose',
                animate: true,
                animationDuration: 1000,
                nodeRepulsion: 8000,
                nodeOverlap: 20,
                idealEdgeLength: 100,
                edgeElasticity: 200
            }
        });

        // Add interactivity
        cy.on('tap', 'node', function(evt) {
            const node = evt.target;
            console.log('Clicked node:', node.data());
            
            // Highlight connected elements
            cy.elements().removeClass('highlighted');
            node.addClass('highlighted');
            node.neighborhood().addClass('highlighted');
        });

        cy.on('tap', 'edge', function(evt) {
            const edge = evt.target;
            console.log('Clicked edge:', edge.data());
        });

        // Layout functions
        function changeLayout(layoutName) {
            cy.layout({
                name: layoutName,
                animate: true,
                animationDuration: 1000
            }).run();
        }

        function resetZoom() {
            cy.zoom(1);
            cy.center();
        }

        function fitToScreen() {
            cy.fit();
        }

        // Update statistics
        function updateStats() {
            const nodeCount = cy.nodes().length;
            const edgeCount = cy.edges().length;
            
            document.getElementById('node-count').textContent = nodeCount;
            document.getElementById('edge-count').textContent = edgeCount;
            
            // Create legend
            const legend = document.getElementById('legend');
            legend.innerHTML = '';
            
            const entityTypes = {};
            cy.nodes().forEach(node => {
                const type = node.data('type');
                entityTypes[type] = (entityTypes[type] || 0) + 1;
            });
            
            Object.entries(entityTypes).forEach(([type, count]) => {
                const item = document.createElement('div');
                item.className = 'legend-item';
                item.innerHTML = `
                    <div class="color-box" style="background-color: ${entityTypeColors[type] || '#ccc'}"></div>
                    <span>${type}: ${count}</span>
                `;
                legend.appendChild(item);
            });
        }

        // Initialize stats
        updateStats();

        // Add highlighting styles
        cy.style()
            .selector('.highlighted')
            .style({
                'opacity': 1,
                'z-index': 999
            })
            .selector(':not(.highlighted)')
            .style({
                'opacity': 0.3
            })
            .update();

        console.log('üéâ Knowledge Graph Visualization loaded!');
        console.log('Click on nodes and edges to interact with them.');
        console.log('Use the buttons above to change layouts and zoom.');
    </script>
</body>
</html>
